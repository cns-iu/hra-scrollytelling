<!doctype html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>2: Identity Crisis</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="img/logo.svg">

    <link href="https://fonts.googleapis.com/css2?family=Cutive&display=swap" rel="stylesheet">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E1811WRJJD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-E1811WRJJD');
    </script>
</head>

<body id="two">
    <!-- section counter -->
    <div id="sectionCounterdiv">
        <p id="sectionCounter"></p>
    </div>

    <!-- section top  -->
    <section class="top">
        <a href=" https://humanatlas.io" class="topLogo">
            <img class="logo" src="img/logo.svg"> Human Atlas Stories
        </a>
        <div class="dropdown">
            <button class="dropbtn"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="#C2CAE5"
                    class="bi bi-list" viewBox="-1 -4 20 20">
                    <path fill-rule="evenodd"
                        d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                </svg>
                <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
                <a href=" https://hubmapconsortium.github.io/hra-previews/pilots/pilot4.html">Scrollytelling Series</a>
                <a href="story1.html">What is a Human Reference Atlas?</a>
                <!-- <a href="story2.html">2. Get to Know Your Anatomical Structures!</a>
                                        <a href="story3.html">3. Learn about Visualizing Cells in the Human Body</a> -->
            </div>
        </div>
    </section>

    <!-- section header/intro -->
    <section class="underconstruction">
        <div class="constructionmid">
            <b><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-cone-striped" viewBox="0 -2 15 16">
                <path d="m9.97 4.88.953 3.811C10.159 8.878 9.14 9 8 9c-1.14 0-2.158-.122-2.923-.309L6.03 4.88C6.635 4.957 7.3 5 8 5s1.365-.043 1.97-.12zm-.245-.978L8.97.88C8.718-.13 7.282-.13 7.03.88L6.275 3.9C6.8 3.965 7.382 4 8 4c.618 0 1.2-.036 1.725-.098zm4.396 8.613a.5.5 0 0 1 .037.96l-6 2a.5.5 0 0 1-.316 0l-6-2a.5.5 0 0 1 .037-.96l2.391-.598.565-2.257c.862.212 1.964.339 3.165.339s2.303-.127 3.165-.339l.565 2.257 2.391.598z"/>
              </svg> This page is under construction.</b>
        </div>
    </section>

        <!-- BotNav -->
        <div class="botNav">
            <a href="story1.html" class="previous"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                    fill="currentColor" class="bi bi-arrow-left" viewBox="0 -3 16 16">
                    <path fill-rule="evenodd"
                        d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z" />
                </svg> Story 1: <span class="prevTitle">What Is An HRA?</span></a>
            <a href="story3.html" class="next">Story 3: <span class="nextTitle">Learn about Visualizing Cells in the
                    Human
                    Body</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-arrow-right" viewBox="0 -3 16 16">
                    <path fill-rule="evenodd"
                        d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" />
                </svg></a>
        </div>

        <footer>
            &commat; 2023 Human Atlas Design System at Indiana University
        </footer>
        </div>
    </section>


</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollTrigger.min.js"></script>

<script src="scripts.js"></script>

<script>

    //typewriter
    var m = 0;
    var txt = 'There are roughly 37 trillion cells in the human body.';
    var speed = 50;

    function typeWriter() {
        if (m < txt.length) {
            document.getElementById("introTypeLine").innerHTML += txt.charAt(m);
            m++;
            setTimeout(typeWriter, speed);
        }
    }
    window.onload = typeWriter;

    //play sound
    ScrollTrigger.create({
        trigger: ".introline",
        start: "top top",
        end: "bottom bottom",
        onEnter: playsound,
        pin: false,
        pinSpacing: false,
        once: true
    });

    function playsound() {
        var audio = new Audio('music/dramatic.swf.mp3');
        audio.play();
        audio.volume = 0.5;
    }

    //bg1
    ScrollTrigger.create({
        trigger: ".scene1",
        start: "top top",
        end: "+=300%",
        anticipatePin: 1,
        pin: true,
        pinSpacing: false
    });

    //bg2
    ScrollTrigger.create({
        trigger: ".scene2",
        anticipatePin: 1,
        start: "top top",
        end: "+=900%",
        pin: true,
        pinSpacing: false
    });

    //bg3
    ScrollTrigger.create({
        trigger: ".scene3",
        start: "top top",
        end: "+=400%",
        pin: true,
        pinSpacing: false
    });

    //bg4
    ScrollTrigger.create({
        trigger: ".scene4",
        start: "top top",
        end: "+=700%",
        pin: true,
        pinSpacing: false
    });

    //bg6
    ScrollTrigger.create({
        trigger: ".scene5",
        start: "top top",
        end: "+=400%",
        pin: true,
        scrub: 1,
        pinSpacing: false,
    });

    const newtime = gsap.timeline({
        scrollTrigger: {
            trigger: '.scene6',
            start: 'top top',
            end: '-=100%',
            scrub: true
        }
    })

    newtime
        .to('#lastbg', {
            opacity: 1,
        })
        .to('#lastbg', {
            opacity: 0,
        }, "<")

   /*  gsap.timeline({
        scrollTrigger: {
            trigger: ".cecevidtalk",
            start: "bottom bottom",
            end: "=+450%",
            scrub: true,
            markers:true,
            pin: false
        }
    })
        .to(".cecevidtalk", {
            opacity: 0,
        }) */

    /* 
        function onleavefunc() {
            console.log("leave");
            console.log(document.getElementById('lastbg').style.backgroundImage);
            if (document.getElementById('lastbg').style.backgroundImage != "none") {
                document.getElementById('lastbg').style.backgroundImage = "none"; // specify the image path here
            }
        }
    
        function onenterfunc() {
            console.log("enter");
            if(document.getElementById('lastbg').style.backgroundImage != "url('img/2scene3.png')"){
                document.getElementById('lastbg').style.backgroundImage = "url('img/2scene3.png')";
            }
        } */


    //fade in txt 
    const containers = gsap.utils.toArray(".container");
    containers.forEach((container) => {
        let tl = gsap.timeline({
            scrollTrigger: {
                onRefresh: self => self.progress && self.animation.progress(1),
                start: "top top",
                trigger: container,
                pin: true,
                pinSpacing: false,
                scrub: true,
                markers: false
            }
        });

        tl.to(container, {
            autoAlpha: 1
        }).to(
            container,
            {
                autoAlpha: 0
            },
            0.5
        );
    });

    //fade in txt 
    const overlays = gsap.utils.toArray(".overlaybubbles");
    overlays.forEach((obubble) => {
        let tl = gsap.timeline({
            scrollTrigger: {
                trigger: obubble,
                pin: true,
                pinSpacing: false,
                scrub: true,
                markers: false
            }
        });

        tl.to(obubble, {
            autoAlpha: 1
        }).to(
            obubble,
            {
                autoAlpha: 0
            },
            0.5
        );
    });

    //fade in txt 
    const bubbles = gsap.utils.toArray(".talkbubble");
    bubbles.forEach((bubble) => {
        let tl = gsap.timeline({
            scrollTrigger: {
                trigger: bubble,
                start: "top top",
                scrub: 0.5,
                pin: true,
                pinSpacing: false,
                scrub: true,
                markers: false
            }
        });

        tl.to(bubble, {
            autoAlpha: 1
        }).to(
            bubble,
            {
                autoAlpha: 0
            },
            0.5
        );
    });

    //spritesheet animation
    var spriteSheet = {
        width: 900,
        height: 1200,
        total: 20,
        cols: 1,
        rows: 20,
        duration: 1,
    };

    var tl = gsap.timeline({
        scrollTrigger: {
            scrub: 0.25,
            pin: ".spritecontainer",
        }
    });

    tl.from(".spritecontainer", {
        duration: 0.25,
    }, 0)
        .to(".spritecontainer", {
            duration: 0.25,
        }, 0.75)
        .to(".fadeinimg", {
            opacity: 1,
            duration: 0.25,
        }, 0.75)

    for (var i = 0; i < spriteSheet.total; i++) {
        tl.set(".frames", {
            x: (i % spriteSheet.cols) * -spriteSheet.width,
            y: Math.floor(i / spriteSheet.cols) * -spriteSheet.height
        }, i / (spriteSheet.total - 1) * spriteSheet.duration);
    }

    window.onbeforeunload = function () {
        window.scrollTo(0, 0);
    }

    window.history.scrollRestoration = "manual";

</script>

</html>